var fs = require('fs')
var objects = require('./objects')

function SetIcon(document, iconpath) {
    if (fs.existsSync(iconpath)) {
        document.setresponsehandler(function() {
            document.GetRawResponse().sendFile(`${process.cwd()}/${iconpath}`)
        }, "/favicon.ico")

        var faviconlink = new objects.JSLinkObject("favicon.ico", "icon")
        faviconlink.Arguments += ' type="image/x-icon"'

        document.AddHeaderObject(faviconlink)
    }
}

module.exports = SetIcon